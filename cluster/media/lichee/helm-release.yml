---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: lychee
  namespace: media
spec:
  releaseName: lychee
  chart:
    repository: https://k8s-at-home.com/charts
    name: lychee
    version: 3.2.0
  values:
    #
    # IMPORTANT NOTE
    #
    # This chart inherits from our common library chart. You can check the default values/options here:
    # https://github.com/k8s-at-home/charts/tree/master/charts/common/values.yaml
    #

    image:
      repository: lycheeorg/lychee-laravel
      pullPolicy: IfNotPresent
      tag: v4.0.8

    strategy:
      type: Recreate

    env: {}
      # PHP_TZ: UTC
      # PUID: 1001
      # PGID: 1001

    service:
      port:
        port: 80

    ingress:
      enabled: true
      annotations:
        kubernetes.io/ingress.class: nginx
      hosts:
        - host: photos.kube.luander.net

    persistence:
      config:
        enabled: true
        emptyDir: false
        mountPath: /conf
        ## Persistent Volume Storage Class
        ## If defined, storageClassName: <storageClass>
        ## If set to "-", storageClassName: "", which disables dynamic provisioning
        ## If undefined (the default) or set to null, no storageClassName spec is
        ##   set, choosing the default provisioner.  (gp2 on AWS, standard on
        ##   GKE, AWS & OpenStack)
        storageClass: longhorn
        accessMode: ReadWriteOnce
        size: 1Gi
        ## Do not delete the pvc upon helm uninstall
        # skipuninstall: false
        # existingClaim: ""

      uploads:
        enabled: true
        emptyDir: false
        mountPath: /uploads
        ## Persistent Volume Storage Class
        ## If defined, storageClassName: <storageClass>
        ## If set to "-", storageClassName: "", which disables dynamic provisioning
        ## If undefined (the default) or set to null, no storageClassName spec is
        ##   set, choosing the default provisioner.  (gp2 on AWS, standard on
        ##   GKE, AWS & OpenStack)
        storageClass: longhorn
        accessMode: ReadWriteOnce
        size: 10Gi
        ## Do not delete the pvc upon helm uninstall
        # skipuninstall: false
        # existingClaim: ""

      sym:
        enabled: true
        emptyDir: false
        mountPath: /sym
        ## Persistent Volume Storage Class
        ## If defined, storageClassName: <storageClass>
        ## If set to "-", storageClassName: "", which disables dynamic provisioning
        ## If undefined (the default) or set to null, no storageClassName spec is
        ##   set, choosing the default provisioner.  (gp2 on AWS, standard on
        ##   GKE, AWS & OpenStack)
        storageClass: longhorn
        accessMode: ReadWriteOnce
        size: 10Gi
        ## Do not delete the pvc upon helm uninstall
        # skipuninstall: false
        # existingClaim: ""